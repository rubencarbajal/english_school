<div class="min-h-screen bg-slate-900 flex items-center justify-center px-4 py-12">
  <div class="w-full max-w-lg bg-slate-800/50 border border-slate-700 rounded-xl p-6 md:p-8 shadow-2xl animate-fade-in">

    <!-- Title -->
    <h1
      class="text-4xl md:text-5xl font-extrabold tracking-tight bg-clip-text text-transparent bg-gradient-to-r from-sky-400 to-blue-500 text-center">
      Reset your password
    </h1>
    <p class="mt-2 text-center text-slate-400">
      Set a new password for your account.
    </p>

    <!-- Error -->
    @if (error()) {
      <div class="mt-6 rounded-lg border border-amber-500/50 bg-amber-500/10 p-3 text-amber-400">
        {{ error() }}
      </div>
    }

    <!-- Success -->
    @if (done()) {
      <div class="mt-6 rounded-lg border border-emerald-600 bg-emerald-500/10 p-3 text-emerald-400">
        Your password has been updated. Redirecting to loginâ€¦
      </div>
    }

    <!-- Form -->
    <form class="mt-8 space-y-6" [formGroup]="form" (ngSubmit)="submit()" novalidate>
      <!-- Password -->
      <div>
        <label for="new-password" class="block text-sm text-slate-400 mb-1">New password</label>
        <div class="relative">
          <input
            id="new-password"
            [type]="showPass1() ? 'text' : 'password'"
            formControlName="password"
            name="new-password"
            autocomplete="new-password"
            class="w-full rounded-lg bg-slate-900 border border-slate-700 px-4 py-3 pr-12 text-white placeholder:text-slate-500 focus:outline-none focus:ring-2 focus:ring-sky-500 transition-all"
            placeholder="Create a new password"
          />
          <button type="button"
            (click)="showPass1.set(!showPass1())"
            class="absolute inset-y-0 right-0 px-3 text-slate-300 hover:text-white transition-colors"
            aria-label="Toggle password visibility">
            @if (showPass1()) { ğŸ‘ï¸ } @else { ğŸ‘ï¸â€ğŸ—¨ï¸ }
          </button>
        </div>
        <p class="mt-2 text-sm text-slate-400">{{ passwordHelp() }}</p>

        @if (f.password.touched && f.password.invalid) {
          <p class="mt-2 text-sm text-amber-400">
            @if (f.password.errors?.['required']) { Password is required. } 
            @if (f.password.errors?.['minlength']) { Minimum 8 characters. }
            @if (f.password.errors?.['pattern']) { Include upper/lowercase letters and a number. }
          </p>
        }
      </div>

      <!-- Confirm Password -->
      <div>
        <label for="confirm-password" class="block text-sm text-slate-400 mb-1">Confirm password</label>
        <div class="relative">
          <input
            id="confirm-password"
            [type]="showPass2() ? 'text' : 'password'"
            formControlName="confirmPassword"
            name="new-password"
            autocomplete="new-password"
            class="w-full rounded-lg bg-slate-900 border border-slate-700 px-4 py-3 pr-12 text-white placeholder:text-slate-500 focus:outline-none focus:ring-2 focus:ring-sky-500 transition-all"
            placeholder="Repeat your new password"
          />
          <button type="button"
            (click)="showPass2.set(!showPass2())"
            class="absolute inset-y-0 right-0 px-3 text-slate-300 hover:text-white transition-colors"
            aria-label="Toggle password visibility">
            @if (showPass2()) { ğŸ‘ï¸ } @else { ğŸ‘ï¸â€ğŸ—¨ï¸ }
          </button>
        </div>

        @if (form.hasError('passwordsMismatch') && (f.confirmPassword.touched || f.password.touched)) {
          <p class="mt-2 text-sm text-amber-400">Passwords do not match.</p>
        }
        @if (f.confirmPassword.touched && f.confirmPassword.invalid && !form.hasError('passwordsMismatch')) {
          <p class="mt-2 text-sm text-amber-400">
            @if (f.confirmPassword.errors?.['required']) { Confirmation is required. }
          </p>
        }
      </div>

      <button
        type="submit"
        [disabled]="loading() || !token() || form.invalid"
        class="w-full font-semibold py-3 px-8 rounded-lg transition-colors duration-300 bg-emerald-500 hover:bg-emerald-600 text-white disabled:opacity-60 disabled:cursor-not-allowed"
      >
        @if (!loading()) { Update Password } @else { Updatingâ€¦ }
      </button>

      <div class="text-center">
        <a routerLink="/auth" class="text-sky-400 hover:underline text-sm">Back to login</a>
      </div>
    </form>
  </div>
</div>
